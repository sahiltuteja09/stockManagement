<ion-header>
    <ion-toolbar color="primary">
      <ion-buttons slot="start">
        <ion-menu-button></ion-menu-button>
      </ion-buttons>
      <ion-title>
        My products
      </ion-title>
      <ion-buttons slot="secondary" routerLink="/addnewstock" >
        <ion-button>
          <ion-icon slot="icon-only" name="add"></ion-icon> Add New
        </ion-button>
      </ion-buttons>
    </ion-toolbar>
  </ion-header>
  

  <ion-content>
      <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
          <ion-refresher-content pullingIcon="arrow-dropdown" pullingText="Pull to refresh" refreshingSpinner="circles"
            refreshingText="Refreshing...">
          </ion-refresher-content>
        </ion-refresher>
    <div *ngIf="(myproducts.status); else noData">
      <ion-list *ngFor="let product of myproducts.data">
        <ion-card>
          <ion-item>
            <ion-thumbnail slot="start">
              <img [src]="product.image ? img_base+product.image : defaultImage" tappable (click)="openPreview(product.image ? img_base+product.image : defaultImage)">
            </ion-thumbnail>
            <ion-label>
              <p><ion-icon name="create" routerLink="/addnewstock/{{product.id}}"></ion-icon> {{product.title}} </p>
              <ion-row>
              <ion-col size="9" size-sm align-items-end>
                <small class="deal_price">
                  {{product.likes}} Likes | Available : {{product.quantity}}
                  | Live date : {{product.date_added | timeAgo}} 
                </small>
              </ion-col>
            </ion-row>
          <ion-row>
              <ion-col size="9" size-sm align-items-end>
                <small class="deal_price">
                  Sold : {{totalSold[product.id]}} 
                  | Return : {{totalReturn[product.id]}} | Loss : {{totalLoss[product.id]}} | Damages :  {{totalDamage[product.id]}}
                </small>
              </ion-col>
            </ion-row>
              <ion-col size="3" size-sm>
                <ion-button (click)="goto('scanin',product)" float-right color="tertiary" shape="round" size="small">
                  <ion-icon name="add"></ion-icon> Stock in
                </ion-button>
              </ion-col>
              <ion-col size="3" size-sm>
                <ion-button (click)="goto('stockout',product)" float-right color="danger" shape="round" size="small">
                  <ion-icon name="remove-circle-outline"></ion-icon> Stock out
                </ion-button>
              </ion-col>
              
            </ion-label>
            
          </ion-item>
          <ion-row>
              <ion-col size="12" size-sm>
                <p [innerHTML]="product.description | safehtml">
              
                </p>
              </ion-col>
            </ion-row>
        </ion-card>
  
      </ion-list>
    </div>
    <ng-template #noData>
      <div class="ion-text-center">
        {{noDataFound}}
      </div>
    </ng-template>
    <ion-infinite-scroll (ionInfinite)="doInfinite($event)">
        <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Loading more data...">
        </ion-infinite-scroll-content>
      </ion-infinite-scroll>
  </ion-content>